# Cache Memory Simulation

_This file with markdown formatting [here](https://github.com/emilio93/ie521/blob/master/tarea1/README.md)._

This project simulates a cache memory with the given parameters in many replacement policies scenarios.

## Contents

- [Compiling](#compiling)
- [Running](#running)
  - [Example of Use](#example-of-use)
- [Running Automated Tests](#running-automated-tests)
- [Plotting the Results](#plotting-the-results)

## Compiling

Install basic developing tools which may not be already in your system

```bash
sudo apt-get update
sudo apt-get install build-essential software-properties-common -y
```

Thits project has been tested with ```g++ 7.2.0```. Check `g++` version:

```bash
which g++
```

In any case, standard `c++17` is required.

Uses zlib and libboost .

```bash
# install zlib
sudo apt-get install zlib1g -y
sudo apt-get install zlib1g-dev -y
# install libboost_iostreams
sudo apt-get install libboost-iostreams-dev -y
```

Compiles via make(installed by default in most systems):

```bash
make
```

_This has to be run from the folder which contains the Makefile._

This generates a symlink to an excecutable, `./cache`.

## Running

A report will be printed in the terminal and a csv file, `results.csv` will be created/updated with the results from the simulation

### Example of Use

```bash
./bin/cache -t 32 -a 4 -l 32 -mp 30 -rp LRU
```

These flags must be declared

- `-t`: cache size in kilobytes(kB). Must be an integer.
- `-a`: cache associativity(1,2,4,...). Must be an integer.
- `-l`: cache block size in bytes. Must be an integer.
- `-mp`: miss penalty in cycles. Must be an integer.
- `-rp`: Replacement policy. Must be any of the implemented replacement policies(case sensitive):
  - `LRU`
  - `NRU`
  - `SRRIP`
  - `random`

If any of the previous flags is not defined or value is invalid, the program will stop.

Optional flags:

```bash
./bin/cache -t 32 -a 4 -l 32 -mp 30 -rp LRU -f data/mcf.trace.gz -c 1.05
```

- `-f`: filepath to gunziped trace. Defaults to `data/art.trace.gz`. Program will stop if problems with file are found(doesn't exist, incorrect format, etc).
- `-c`: cycle multiplier. Defaults to 1. Float type.

Any other tag will be ignored.

## Running Automated Tests

Place all traces to be analyzed in the `./data` folder.
Run the script:

```bash
./runTests.sh
```

## Plotting the Results

A [gnuplot](http://gnuplot.info/) script is provided to plot the miss rates in the simulation.

If gnuplot is not available in your system, install:

```bash
sudo apt-get install gnuplot
```

Then just run the script:

```bash
gnuplot missrates.plt
```

Keep in mind, the missrates script is set to read a file `results.csv`, this file is generated by running the tests.

A new file, `missrates.eps` will be created.

> Eps format is ok in most cases, should you require a pdf file, the following solution is suggested:
> ```bash
> sudo apt-get install ghostscript # install > ps2pdf utility
> ps2pdf missrates.ps missrates.pdf
> ```
